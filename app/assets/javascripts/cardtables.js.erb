 var CP = { 
     divs:  [
    "<%= Card.new(1).make_div %>",
    "<%= Card.new(2).make_div %>",
    "<%= Card.new(3).make_div %>",
    "<%= Card.new(4).make_div %>",
    "<%= Card.new(5).make_div %>",
    "<%= Card.new(6).make_div %>",
    "<%= Card.new(7).make_div %>",
    "<%= Card.new(8).make_div %>",
    "<%= Card.new(9).make_div %>",
    "<%= Card.new(10).make_div %>",
    "<%= Card.new(11).make_div %>",
    "<%= Card.new(12).make_div %>",
    "<%= Card.new(13).make_div %>",
    "<%= Card.new(14).make_div %>",
    "<%= Card.new(15).make_div %>",
    "<%= Card.new(16).make_div %>",
    "<%= Card.new(17).make_div %>",
    "<%= Card.new(18).make_div %>",
    "<%= Card.new(19).make_div %>",
    "<%= Card.new(20).make_div %>",
    "<%= Card.new(21).make_div %>",
    "<%= Card.new(22).make_div %>",
    "<%= Card.new(23).make_div %>",
    "<%= Card.new(24).make_div %>",
    "<%= Card.new(25).make_div %>",
    "<%= Card.new(26).make_div %>",
    "<%= Card.new(27).make_div %>",
    "<%= Card.new(28).make_div %>",
    "<%= Card.new(29).make_div %>",
    "<%= Card.new(30).make_div %>",
    "<%= Card.new(31).make_div %>",
    "<%= Card.new(32).make_div %>",
    "<%= Card.new(33).make_div %>",
    "<%= Card.new(34).make_div %>",
    "<%= Card.new(35).make_div %>",
    "<%= Card.new(36).make_div %>",
    "<%= Card.new(37).make_div %>",
    "<%= Card.new(38).make_div %>",
    "<%= Card.new(39).make_div %>",
    "<%= Card.new(40).make_div %>",
    "<%= Card.new(41).make_div %>",
    "<%= Card.new(42).make_div %>",
    "<%= Card.new(43).make_div %>",
    "<%= Card.new(44).make_div %>",
    "<%= Card.new(45).make_div %>",
    "<%= Card.new(46).make_div %>",
    "<%= Card.new(47).make_div %>",
    "<%= Card.new(48).make_div %>",
    "<%= Card.new(49).make_div %>",
    "<%= Card.new(50).make_div %>",
    "<%= Card.new(51).make_div %>",
    "<%= Card.new(52).make_div %>",
    "<%= Card.make_back %>"	 
     ],
     create_card: function(card_id,element_id,position){
	 var card = {
	     card_id: card_id,
	     position: position,
	     element_id: element_id,
	     make_div: function() {
		 if (this.card_id != 53 ) {
		     return "<div class='card' id='" + element_id + "'>" + CP.divs[card_id-1] +  "</div>";
		 } else {
		     return "<div class='card' id='" + element_id + "'>" + CP.divs[52] +  "</div>";
		 };
	     },
	     get_div: function() {
		 return $('#' + element_id);
		 },
	     show: function(parent,z){
		 this.get_div().remove();
		 parent.prepend(this.make_div());
		 console.log(position);
		 this.get_div().css({position: "absolute"}).css({left:position.x + "px",top:position.y+"px",zIndex:z})
	     },
	     flip: function(){
		 this.card_id = 53;
		 },
	     move_to: function(position) {
		 this.position = {x: position.x-this.position.x,
				  y: position.y-this.position.y};
		 console.log("Move to " + this.position.x);
		 console.log("Move to " + this.position.y);
		 this.get_div().snabbt({position:[this.position.x,this.position.y,0]});
		 console.log(this.get_div());
	     }
	 };
	  return card;
     }
 };


$(document).ready(function(){
     var ele = $("#cardtable");
     ele.css({position: 'relative'});
     var cards = [];
     for (var i=1; i<54; i++){
        cards[i] = CP.create_card(i,"c"+i,{x: 100+20*i,y: 100});
        cards[i].show(ele,i)
	console.log(cards[i].element_id);
     };
     cards[14].get_div().snabbt({ position:[110,200,0]});
});
